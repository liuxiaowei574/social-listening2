webpackJsonp([4],{"P+bd":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("a3Yh"),s=a.n(r),i={title:{text:"声量",left:30},tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},legend:{data:[]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:[]}],yAxis:[{type:"value"}]};function c(e){if(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())}}i.series=[],i.xAxis.data=[],i.legend.data=[],i.series=[];var o={name:"projectVoice",data:function(){return{showSearch:!0,labelPosition:"right",search:{start:"",end:"",comparison:"",weibo:!0,tmall:!1,jd:!1,jd_intelligent:!1}}},computed:{project:function(){return this.$store.getters.getProjectById(this.$route.params.projectId)},comparisonProject:function(){return this.$store.getters.getProjectById(this.search.comparison)}},mounted:function(){var e=this;this.$nextTick(function(){e.initCharts()})},created:function(){this.initPageDate()},watch:{$route:"initPageDate"},methods:{initPageDate:function(){var e=this,t=e.$store.getters.getProjectById(e.$route.params.projectId);if(0==this.search.end){var a=Date.now();this.search.end=a>t.end?t.end:a}0==this.search.start&&(this.search.start=t.start);var r=t.source;r.indexOf("1")>-1&&(e.search.weibo=!0),r.indexOf("2")>-1&&(e.search.jd_intelligent=!0),r.indexOf("3")>-1&&(e.search.jd=!0),r.indexOf("4")>-1&&(e.search.tmall=!0),e.searchData(),this.$store.dispatch("voiceTagSearch",{project_id:e.$route.params.projectId}).then(function(t){for(var a,r=echarts.init(e.$el.getElementsByClassName("project-chart")[1]),i=0;i<t.length;i++)for(var c=t[i].value,o=i;o<t.length;o++)if(c<t[o].value){var n=t[i];t[i]=t[o],t[o]=n,c=t[i].value}for(var l=[],h=0;h<10;h++)l.push(t[h]);r.clear();var d={xAxis3D:{type:"category",name:"",data:[],axisLabel:{interval:0}},yAxis3D:{type:"category",name:"",data:[0]},zAxis3D:{type:"value",name:""},grid3D:(a={boxWidth:400,boxDepth:80},s()(a,"boxDepth",10),s()(a,"viewControl",{distance:250,alpha:0,beta:0}),a),series:[{type:"bar3D",data:[],shading:"lambert",itemStyle:{opacity:.8},emphasis:{label:{formatter:function(e){return e.data.value[0]+":"+e.data.value[2]}}}}]};for(h=0;h<l.length;h++)d.xAxis3D.data.push({value:l[h].name,textStyle:{fontSize:14,fontWeight:"lighter"}}),d.series[0].data.push({value:[l[h].name,0,l[h].value],itemStyle:{color:"rgb("+[Math.round(255*Math.random()),Math.round(255*Math.random()),Math.round(255*Math.random())].join(",")+")"}});r.setOption(d)},function(e){console.log(e)})},searchData:function(){var e=this;this.search.end-this.search.start>864e5&&(this.$loading(),this.fetchData(e.$route.params.projectId).then(function(t){e.search.comparison?e.fetchData(e.search.comparison).then(function(a){e.initData(t,a)},function(){console.log("获取对比项目数据失败",error)}):e.initData(t)},function(e){console.log(e)}))},fetchData:function(e){var t;return t=this.$store.getters.getSourceId(this.search.weibo,this.search.jd_intelligent,this.search.jd,this.search.tmall),this.$store.dispatch("voiceSearch",{project_id:e,source_id:t,start_time:this.search.start,end_time:this.search.end})},initData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(this.$loading().close(),e=e.sort(function(e,t){return Date.parse(e.name)>Date.parse(t.name)}),t=t.sort(function(e,t){return Date.parse(e.name)>Date.parse(t.name)}),this.search.end-this.search.start>864e5){for(var a=[],r=[],s=[],o=this.search.start,n=this.search.end+864e5;o<n;o+=864e5){var l=c(o);a.push(l)}for(var h=e.shift(),d=t.shift(),u=0;u<a.length;u++){var p=0,v=0;h&&h.name==a[u]&&(p=h.value,h=e.shift()),d&&d.name==a[u]&&(v=d.value,d=t.shift()),r.push(p),s.push(v)}if(i.xAxis[0].data=a,i.legend.data=[this.project.name],i.series=[{name:this.project.name,type:"line",areaStyle:{normal:{}},data:r,smooth:!0}],this.search.comparison){var m=this.$store.getters.getProjectById(this.search.comparison);i.legend.data.push(m.name),i.series.push({name:m.name,type:"line",areaStyle:{normal:{}},data:s,smooth:!0})}this.initCharts()}},initCharts:function(){var e=echarts.init(this.$el.getElementsByClassName("project-chart")[0]);e.clear(),e.setOption(i)}}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("project-header",{attrs:{projectId:e.$route.params.projectId,activeName:"声量"}}),e._v(" "),a("div",{staticClass:"project-show"},[a("div",{staticClass:"project-search"},[a("div",{staticClass:"project-search-btn",on:{click:function(t){e.showSearch=!e.showSearch}}},[e._v("\n              高级筛选 \n              "),a("div",{staticClass:"project-search-btn-arrow",class:[e.showSearch?"el-icon-arrow-up":"el-icon-arrow-down"]})]),e._v(" "),a("el-form",{attrs:{"label-position":"right","label-width":"100px",model:e.search}},[a("el-collapse-transition",[a("div",{directives:[{name:"show",rawName:"v-show",value:e.showSearch,expression:"showSearch"}],staticClass:"project-search-condition"},[a("el-form-item",{attrs:{label:"时间节点："}},[a("el-date-picker",{attrs:{type:"date","value-format":"timestamp",placeholder:"开始日期"},model:{value:e.search.start,callback:function(t){e.$set(e.search,"start",t)},expression:"search.start"}}),e._v(" "),a("div",{staticClass:"el-input",staticStyle:{width:"auto"}},[e._v("至")]),e._v(" "),a("el-date-picker",{attrs:{type:"date","value-format":"timestamp",placeholder:"结束日期"},model:{value:e.search.end,callback:function(t){e.$set(e.search,"end",t)},expression:"search.end"}}),e._v(" "),a("div",{staticClass:"el-input project-search-source-text"},[e._v("信息源：")]),e._v(" "),a("div",{staticClass:"el-input project-search-source"},[a("div",{staticClass:"project-search-source-base",class:[e.search.weibo?"project-search-source-weibo-active":"project-search-source-weibo"],attrs:{title:"微博"},on:{click:function(t){e.search.weibo=!e.search.weibo}}}),e._v(" "),a("div",{staticClass:"project-search-source-base",class:[e.search.jd_intelligent?"project-search-source-jd_intelligent-active":"project-search-source-jd_intelligent"],attrs:{title:"京东达人"},on:{click:function(t){e.search.jd_intelligent=!e.search.jd_intelligent}}}),e._v(" "),a("div",{staticClass:"project-search-source-base",class:[e.search.jd?"project-search-source-jd-active":"project-search-source-jd"],attrs:{title:"京东商城"},on:{click:function(t){e.search.jd=!e.search.jd}}}),e._v(" "),a("div",{staticClass:"project-search-source-base",class:[e.search.tmall?"project-search-source-tmall-active":"project-search-source-tmall"],attrs:{title:"天猫"},on:{click:function(t){e.search.tmall=!e.search.tmall}}})]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.searchData()}}},[e._v("查询")])],1)],1)]),e._v(" "),a("el-form-item",{staticStyle:{"margin-top":"10px"},attrs:{label:"项目对比："}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){e.searchData()}},model:{value:e.search.comparison,callback:function(t){e.$set(e.search,"comparison",t)},expression:"search.comparison"}},e._l(e.$store.getters.getComparisonProjectOptions(this.$route.params.projectId),function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1)],1),e._v(" "),a("div",{staticClass:"project-chart"}),e._v(" "),a("div",{staticClass:"project-chart"})])],1)},staticRenderFns:[]};var l=a("Z0/y")(o,n,!1,function(e){a("WYV3")},null,null);t.default=l.exports},WYV3:function(e,t){},a3Yh:function(e,t,a){"use strict";t.__esModule=!0;var r,s=a("liLe"),i=(r=s)&&r.__esModule?r:{default:r};t.default=function(e,t,a){return t in e?(0,i.default)(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}},adMp:function(e,t,a){a("pBXl");var r=a("UusJ").Object;e.exports=function(e,t,a){return r.defineProperty(e,t,a)}},liLe:function(e,t,a){e.exports={default:a("adMp"),__esModule:!0}},pBXl:function(e,t,a){var r=a("MITN");r(r.S+r.F*!a("M7ni"),"Object",{defineProperty:a("qRYU").f})}});